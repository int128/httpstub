name: build

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - uses: actions/setup-java@v1
      with:
        java-version: 11
    - uses: actions/cache@v2
      with:
        path: |
          ~/.gradle/caches
          ~/.gradle/wrapper
        key: ${{ runner.os }}-gradlew-${{ hashFiles('**/*.gradle') }}
        restore-keys: ${{ runner.os }}-gradlew
    - run: ./gradlew --no-daemon build
    - uses: docker://ghcr.io/enricomi/publish-unit-test-result-action:v1.6
      if: always()
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        files: build/test-results/**/*.xml
